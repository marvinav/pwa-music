# react-template@1.0.0

Custom template to create React Sites.
Этот файл лучше смотреть в режиме Preview.

## Установка

Download node at [nodejs.org](http://nodejs.org) and install it, if you haven't already.

```sh
npm install --save
```

## Development

```sh
npm run start
```

Структура проекта состоит из следующих папок.

### Папку Src:

1. Contexts - здесь содержатся описание интерфейсов React Context без конкретной реализации, чтобы в случае необходимости поменять модуль на другой не приходилось менять код везде. В этом случае, весь код реализован в Providers. Поэтому если например придётся поменять логику авторизации (AuthContext), то код меняется только в соответствующем AuthProvider. Таким образом реализуется слабо-связанный код. Сам контекст используется как глобальное хранилище состояния приложения. Более подробную информацию можно получить [здесь](https://reactjs.org/docs/context.html).
2. Providers - как было сказано в пункте выше, здесь хранится конкретная реализация Context.
3. Pages - здесь уже реализации отдельных страниц приложения, при этом сами страницы могут содержать в себе другие страницы.
4. Components - в эту папку пишется все реакт-компонентны, которые отвечают за отрисовку UI элементов. При этом должно выполняться правило у всех этих элементов - они не должны использовать Context, за исключением ThemeProvider/ThemeContext. Таким образом упрощается их переиспользование.
5. Layouts - в эту папку помещаются элементы, которые с одной стороны связаны с контекстом, но не являются самим содержанием страницы, однако помогают например навигации. Сюда можно поместить NavBar, SearchBar, Drawer.
6. Services - вспомогательные службы (но не реакт компоненты! То есть сюда нельзя класть файлы с расширением tsx). Тут могут быть разные службы управления куки например.
7. Utils - вспомогательные утилиты, которые выполняют слишком специфичную функцию и чаще всего должны соответствовать **чистым** функциям. Например, какой-нибудь скрипт декодинга-кодинга.

### Static

Все статичные файлы помещаются в папку static. Ссылка на них в коде должна осуществляться обязательно через разные препроцессоры, которые устанавливаются и настраиваются в webpack.config.js. Для примера в странице Home показана отрисовка картинки.

### Файлы конфигурации

-   webpack.config.js - конфигурация вебпак. Настроены все препроцессоры, а также dev-server со спецификой SPA-приложений, то есть не важно, какой адрес указан в url, грузится всегда будет один и тот же index.html.
-   .babelrc - конфигурация бабеля для полиморфов и транслитерации.
-   package.json - конфигурация проекта nodejs.
-   favicon.config.js - конфигурация прикольной библиотеки, которая настраивает метаданные для сайта (фавиконы, имя и прочее).
-   .eslintrc.js - конфигурация линтера.
-   .prettierrc.js - конфигурация преттира.
-   tsconfig.json - конфигурация typescript.
-   .gitignore - конфигурация git для игнорирования файлов, чтобы в проект не лезли скомпилированный код и всякий другой дев-мусор.

### Другие правила

В проекте используется реализация хранения состояния приложений с помощью комбинации hooks-context. Сейчас это современный тренд, который вытеснил redux как по простоте написания кода, простоте его поддержки и скорости работы всего приложения.
React Hook это рекомендуемый подход написания кода, классы сейчас считай что Deprecated. Их и сложно писать, и много подводных камней с ними.

## Инструменты разработчика

В проекте настроены отладка, форматеры по умолчанию и рекомендуемые расширения для vscode.

### Расширения

> Инструкция по установке рекомендуемых расширений [здесь](https://code.visualstudio.com/docs/editor/extension-gallery#_workspace-recommended-extensions).

### Отладка

Отладка работает в режиме HMR (Hot Module Replacement): то есть если ты изменишь какую-то переменную в коде, то у тебя не перегрузится вся страница, а только обновится информация в том коде, который был затронут. Это очень удобно, можно протестрировать например в [этом месте](./src/pages/Home/index.tsx#L10)
Также, настроен отладчик в хроме, чтобы ты могла ставить breakpoint внутри vscode, и выполняемый код в браузере могла смотреть внутри vscode со всеми преимуществами (смотреть значение всех переменных в runtime например). Для этого тебе нужно

1. Запустить google chrome в режиме разработчика одним из двух способов: 1. Right click the Chrome shortcut, and select properties
   In the "target" field, append --remote-debugging-port=9222 2. Or in a command prompt, execute <path to chrome>/chrome.exe --remote-debugging-port=9222
2. Запустить webpack-dev-server
3. Открыть в хроме страницу https://localhost:8080
4. Запустить отладку "Attach Chrome"

### Форматирование кода и линтеры

В качестве линтера и форматера используется комбинация eslint-prettier. Eslint отвечает за правила написания грамотного кода, prettier за его внешность. Если у тебя будут установлено рекомендуемые расширения Eslint и Prettier, то в Vscode ты будешь видеть ошибки и предупреждения от этих двух модулей.

Также после написания кода полезно и нужно выполнить проверку кода линтером. Ну и это избавляет тебя от необходимости устанавливать расширения, если не хочешь по каким-то убеждениям:

```sh
npm run lint
```

Если будут ошибки или предупреждения их нужно устранить. Если ты считаешь, что правилом можно пренебречь в каком-то случае, то обязательно в коде пишешь соответствующий комментарий, который выключит правило для этого случая. Например, можешь посмотреть, как выключено правило в [AuthProvider.](./src/providers/AuthProvider.tsx#L12)

> 'password' is defined but never used.eslint@typescript-eslint/no-unused-vars
> VSCode обычно подсказывает, какой комментарий нужно написать, чтобы выключить правило.

Для корректного отображения настройки стилей Zabota.Chat должны быть отформатированы:

-   Administration > Layout > Custom CSS

```css
section.page-container.page-home.page-static {
    padding: 0;
}

#rocket-chat > div.rc-old.main-content.content-background-color > section.page-container.page-home > header {
    display: none;
}

section.page-container.page-home.page-static > div.content {
    margin: 0;
    padding: 0;
}
```

-   Administration > Layout > Content

```html
<iframe height="100%" id="special-iframe"></iframe>

<iframe
    hidden
    onload="document.getElementById('special-iframe').src=`https://localhost:3000/home?hostUrl=${btoa(window.location)}`"
></iframe>
```
